---
title: "replication_report"
author: "Yari & Kyonne" 
date: "February 22, 2015"
output: html_document
---

Plan for replication project
(1) power analyses - with and without outliers
(2) moderation analysis by gender
(3) graph the results with ggplot2


1: Get data
```{r}
#load packages:
library(pwr)
library(dplyr)
library(plyr)
library(ggplot2)
library(MBESS)
library(psych)
library(car)
library(lsr)

#load data:
dat <- read.csv("GORN_study3.csv", header = TRUE)
head(dat)
View(dat)

#center predictor variable (using blanks for variable name until we get the translated documents:
dat$X.center<-scale(dat$X, center=TRUE, scale=FALSE)

#set moderator as a factor
dat$M<-as.factor(dat$M)

#Test for homogeneity of variance:
leveneTest(dat$X ~ dat$M, center = mean)

#simple effect of centered predictor on Y
model.centered<-lm(dat$______ ~ dat$______.center)
summary(model.centered)

#centered models:
m1.cent<-lm(dat$Y ~ dat$X.center 
            + dat$M)
summary(m1.cent)

m2.cent<-lm(dat$Y ~ dat$X.center 
            + dat$M
            + (dat$X.center*dat$M))
summary(m2.cent)

#compare models
anova(m1.cent, m2.cent)



```

Graph results of moderation analysis

```{r, echo=FALSE}
##Scatterplots
graph.simple = ggplot(dat, aes(x = wmc.center, y = stroop.rt)) 
graph.simple + geom_smooth(method = "lm") +
  geom_point() +
  ggtitle("Simple Effect of Working Memory on Stroop Performance (RT)") +
  ylab("Stroop RT") +
  xlab("Working Memory Deviation Score from Mean")

graph.moderator = ggplot(dat, aes(x = X.center, y = Y, colour = M)) 
graph.moderator + geom_smooth(method = "lm") +
  geom_point() +
  ggtitle("Working Memory on Stroop Performance (RT)") +
  ylab("Stroop RT") +
  xlab("Working Memory Deviation Score from Mean")
```

Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.
